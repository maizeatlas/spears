(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      7419,        170]
NotebookOptionsPosition[      7111,        156]
NotebookOutlinePosition[      7465,        172]
CellTagsIndexPosition[      7422,        169]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Set", " ", "directory", " ", "where", " ", "RABBIT", " ", "packages", 
     " ", "are", " ", "downloaded"}], ",", " ", 
    RowBox[{"pull", " ", "required", " ", "package"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "SetDirectory", "[", "\"\</Directory/RABBIT/RABBIT_Packages\>\"", "]"}], 
   "\n", 
   StyleBox[
    RowBox[{"Needs", "[", "\"\<MagicReconstruct`\>\"", "]"}], "Input"], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Change", " ", "directory", " ", "to", " ", "the", " ", "directory", " ",
       "where", " ", "this", " ", "notebook", " ", "is", " ", "saved"}], ",", 
     " ", 
     RowBox[{
     "needs", " ", "to", " ", "have", " ", "input", " ", "file", " ", "from", 
      " ", "4", "_MACH", "_to", "_RABBIT", 
      RowBox[{"_format", ".", "R"}]}]}], "*)"}], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   StyleBox[
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "Input"], 
   StyleBox[" ", "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"model", " ", "=", " ", "\"\<jointModel\>\""}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"designate", " ", "model"}], ",", " ", 
     RowBox[{"here", " ", "using", " ", "joint", " ", "model"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"estfun", " ", "=", " ", "\"\<origViterbiDecoding\>\""}], ";"}], 
   " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"desigante", " ", "algorithm"}], ",", " ", 
     RowBox[{"can", " ", "be", " ", "origViterbiDecoding"}], ",", " ", 
     "origPosteriorDecoding", ",", " ", 
     RowBox[{"or", " ", "origPathSampling"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", " ", "=", "1"}], ",", " ", 
     RowBox[{"j", " ", "\[LessEqual]", " ", "10"}], ",", " ", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"magicsnp", " ", "=", " ", 
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{"\"\<SimData_Rsq50pct_chrom\>\"", " ", "<>", " ", 
          RowBox[{"ToString", "[", "j", "]"}], " ", "<>", " ", 
          "\"\<_RABBIT_input.csv\>\""}], ",", "\"\<CSV\>\""}], "]"}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"popdesign", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
         "0.156656", ",", "0.000930313", ",", "0.582508", ",", "2.61506", ",",
           "0.582507", ",", "2.61505"}], "}"}], "}"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"popdesign", " ", "=", " ", 
         RowBox[{
         "prior", " ", "calculated", " ", "based", " ", "on", " ", "specific",
           " ", "population", " ", "pedigree", " ", 
          RowBox[{"see", ":", " ", 
           RowBox[{"Zheng", " ", "et", " ", 
            RowBox[{"al", ".", " ", "2015"}]}]}]}]}], ",", " ", 
        RowBox[{
        "can", " ", "input", " ", "priors", " ", "or", " ", "designate", " ", 
         "pedigree", " ", "here"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"magicReconstruct", "[", 
       RowBox[{"magicsnp", ",", "model", ",", "popdesign", ",", " ", 
        RowBox[{"reconstructAlgorithm", "\[Rule]", "estfun"}], ",", 
        RowBox[{"outputFileID", "\[Rule]", 
         RowBox[{"\"\<SimData_Rsq50pct_chrom\>\"", " ", "<>", " ", 
          RowBox[{"ToString", "[", "j", "]"}], " ", "<>", " ", 
          "\"\<_RABBIT_jointModel_OVD_output\>\""}]}], ",", 
        RowBox[{"isPrintTimeElapsed", "\[Rule]", "True"}]}], "]"}], " ", ";", 
      
      RowBox[{"(*", 
       RowBox[{
       "Define", " ", "parameters", " ", "for", " ", "magicReconstruct"}], 
       "*)"}], "\[IndentingNewLine]", " ", 
      RowBox[{"saveAsSummaryMR", "[", 
       RowBox[{
        RowBox[{"\"\<SimData_Rsq50pct_chrom\>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", "j", "]"}], " ", "<>", 
         "\"\<_RABBIT_jointModel_OVD_output_magicReconstruct.txt\>\""}], ",", 
        
        RowBox[{"\"\<SimData_Rsq50pct_chrom\>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", "j", "]"}], " ", "<>", 
         "\"\<_RABBIT_jointModel_OVD_output_magicReconstruct_Summary.csv\>\""}\
]}], "]"}]}]}], 
    RowBox[{"(*", 
     RowBox[{"output", " ", "summary"}], "*)"}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.733128170679484*^9, 3.733128189498996*^9}, {
   3.7331295708328257`*^9, 3.7331295891995077`*^9}, {3.733129728276643*^9, 
   3.7331297577269583`*^9}, {3.733129851206983*^9, 3.7331298564359093`*^9}, {
   3.733129921092806*^9, 3.733129927368237*^9}, {3.733130014671776*^9, 
   3.733130017425753*^9}, {3.733130267507827*^9, 3.733130269890637*^9}, {
   3.7331303522229567`*^9, 3.733130355056026*^9}, {3.7331304719137897`*^9, 
   3.733130474937813*^9}, {3.73313051787071*^9, 3.7331305205571957`*^9}, {
   3.733130574931562*^9, 3.7331305771568117`*^9}, {3.7331306464603367`*^9, 
   3.733130649360017*^9}, {3.735848435848894*^9, 3.7358484480271177`*^9}, {
   3.73584880703321*^9, 3.7358488079994593`*^9}, {3.7358488586714497`*^9, 
   3.735848891565434*^9}, 3.7405252560593567`*^9, {3.74052807999596*^9, 
   3.74052810562994*^9}, {3.7410020725887337`*^9, 3.741002083343528*^9}, {
   3.7634116696624107`*^9, 3.76341173902346*^9}, {3.76738558840243*^9, 
   3.767385629794641*^9}, {3.767560763914571*^9, 3.767560775179434*^9}, {
   3.770675730735527*^9, 3.770675742437755*^9}, {3.780866491027728*^9, 
   3.780866549763486*^9}, {3.784633409433467*^9, 3.784633459246641*^9}, {
   3.784633979444664*^9, 3.784634078133375*^9}, {3.784634147204515*^9, 
   3.7846341529345503`*^9}, {3.78463419082402*^9, 3.7846342136551323`*^9}, {
   3.784634401011806*^9, 3.784634404118421*^9}, {3.790601164508065*^9, 
   3.79060124310609*^9}, 3.79060132388804*^9, {3.79060152817033*^9, 
   3.79060168383934*^9}, {3.792276648484619*^9, 3.7922766501321774`*^9}, 
   3.792276690893585*^9, {3.797599826531719*^9, 3.797599989195648*^9}, {
   3.79760009492383*^9, 3.797600095158766*^9}, {3.797600599856256*^9, 
   3.797600723128119*^9}, 3.7976307228923073`*^9, {3.7976310817515373`*^9, 
   3.7976311084746943`*^9}, {3.797631147244216*^9, 3.7976312470632973`*^9}, {
   3.797631287796517*^9, 3.797631325851644*^9}, 3.79763202534402*^9, {
   3.797632057237904*^9, 3.797632094967166*^9}, {3.797632141871846*^9, 
   3.7976321629067574`*^9}, {3.797632555070087*^9, 
   3.797632556291923*^9}},ExpressionUUID->"b0bad5b8-7190-4262-86d2-\
029e395fd67e"]
},
WindowSize->{808, 911},
WindowMargins->{{184, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 6549, 134, 535, "Input",ExpressionUUID->"b0bad5b8-7190-4262-86d2-029e395fd67e"]
}
]
*)

